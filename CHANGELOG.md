# 更新履歴 (CHANGELOG)

## [1.1.1] - 2026-01-27

### 改善
- **デフォルトDBフォールバック**: クライアントがDB名を指定せず、かつアカウントに特定のDB制限がない場合、サーバー起動時に `--db` で指定されたデータベースを自動的に使用するように改善。
- **サンプルの安定性向上**: `example/accounts.json` に推奨される `allowed_dbs` 設定を追加し、サンプルクライアントの動作を安定化。

### ドキュメント
- **README 更新**: クライアントの使用例を最新の非同期 `RemoteNanaSQLite` 仕様に更新し、マルチDB環境での挙動に関する説明を補足。


## [1.1.0] - 2025-01-24

### 追加
- **RBAC (Role-Based Access Control) システム**: `accounts.json` による複数ユーザー管理とメソッドレベルの権限制限を実装。
- **リアルタイム設定反映**: `watchfiles` を利用し、サーバー再起動なしでアカウント権限の変更を即座に反映。
- **認証プロトコルの最適化**: 認証時にアカウント名のヒントを送信する機能を追加し、署名検証のCPU負荷を大幅に削減（CPU DoS対策）。

### セキュリティ改善
- **Anti-DoS ガードレールの強化**: 未認証時の同時ストリーム数を最大50、合計接続バッファを最大50MBに制限。
- **即時BANチェック**: リクエストごとにBAN状態を再確認し、不正な通信を即座に遮断。

## [1.0.0] - 2025-01-17

### 追加
- 初回リリース
- 許可・禁止メソッドのカスタマイズ機能の追加（プログラム起動時）
- QUIC プロトコル (aioquic) による RPC サーバーの実装
- Ed25519 パスキー認証の実装
- `nanasqlite-server`, `nanasqlite-cert-gen`, `nanasqlite-key-gen` コンソールコマンドの追加
- マルチプラットフォーム (Windows, Linux, macOS) への対応
- 英語・日本語のバイリンガルドキュメント

### セキュリティ改善
- **動的メソッド保護**: `dir(NanaSQLite)` を使用したメソッド検証と `FORBIDDEN_METHODS` ブラックリストによる二重の保護。
- **フラグメンテーション対策**: QUIC ストリームのバッファリング処理の実装。
- **DoS 対策**: ストリームバッファサイズ制限 (10MB) および BAN リストのメモリ制限の実装。
- **非ブロッキング化**: 全ての DB 操作を `ThreadPoolExecutor` で実行するように変更。
- **エラー情報の秘匿**: サーバー内部例外の隠蔽と、安全な例外 (`NanaSQLiteError` 等) のみのクライアントへの返却。
